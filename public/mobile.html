<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<script>
  factorialize = (num) => {
    if (num < 0) return -1;
    else if (num == 0) return 1;
    else {
      return num * factorialize(num - 1);
    }
  };

  binomialPMF = (numSuccess, prob, numTrials) => {
    const permutationFactor =
      factorialize(numTrials) /
      (factorialize(numSuccess) * factorialize(numTrials - numSuccess));
    const orderedFactor =
      Math.pow(prob, numSuccess) * Math.pow(1 - prob, numTrials - numSuccess);
    return permutationFactor * orderedFactor;
  };

  binomialCDF = (numSuccess, prob, numTrials) => {
    let totalProb = 0;
    for (let i = 0; i <= numSuccess; i++) {
      totalProb += binomialPMF(i, prob, numTrials);
    }

    if (isNaN(totalProb)) {
      return "breaks >86 wins";
    } else {
      return (totalProb * 100).toPrecision(3);
    }
  };

  document.addEventListener("DOMContentLoaded", (event) => {
    const winnerButton = document.getElementById('winner-button')
    const loserButton = document.getElementById('loser-button')
    const numWins = document.getElementById("wins-value")
    const numLosses = document.getElementById("losses-value")
    const total = document.getElementById("total")
    const percentile = document.getElementById("percentile")

    winnerButton.addEventListener('click', () => {
      numWins.innerHTML = parseInt(numWins.innerHTML) + 1;
      total.innerHTML = parseInt(total.innerHTML) + 1;
      percentile.innerHTML = binomialCDF(
        parseInt(numWins.innerHTML),
        0.49293,
        parseInt(total.innerHTML)
      );
    })

    loserButton.addEventListener('click', () => {
      numLosses.innerHTML = parseInt(numLosses.innerHTML) + 1;
      total.innerHTML = parseInt(total.innerHTML) + 1;
      percentile.innerHTML = binomialCDF(
        parseInt(numWins.innerHTML),
        0.49293,
        parseInt(total.innerHTML)
      );
    })
  })



</script>

<style>
  .button-holder {
    display: flex;
  }

  #winner-button {
    width: 50%;
  }

  #loser-button {
    width: 50%;
  }

  .prob-row {
    display: flex;
    justify-content: space-between;
  }
</style>


<body>
  <div class="button-holder">
    <div style="width: 100%;">
      <button id="winner-button">winner</button>
      <p>num wins:</p>
      <p id="wins-value">0</p>
    </div>
    <div style="width: 100%;">
      <button id="loser-button">loser</button>
      <p>num losses:</p>
      <p id="losses-value">0</p>
    </div>
  </div>
  <div class="prob-row">
    <p class="simulation-stat">total:</p>
    <p id="total">0</p>
  </div>
  <div class="prob-row">
    <p class="simulation-stat">percentile:</p>
    <p id="percentile">--</p>
  </div>
</body>

</html>